# Домашнее задание к занятию "`Резервное копирование`" - `Андрющенко Вячеслав`


---

### Задание 1   

Составьте команду rsync, которая позволяет создавать зеркальную копию домашней директории пользователя в директорию /tmp/backup

Необходимо исключить из синхронизации все директории, начинающиеся с точки (скрытые)

Необходимо сделать так, чтобы rsync подсчитывал хэш-суммы для всех файлов, даже если их время модификации и размер идентичны в источнике и приемнике.

На проверку направить скриншот с командой и результатом ее выполнения



### Решение 1   

rsync -avP --checksum --exclude '.*' ~/ /tmp/backup 

![Результат](/img/1.png)  


### Задание 2   

Написать скрипт и настроить задачу на регулярное резервное копирование домашней директории пользователя с помощью rsync и cron.

Резервная копия должна быть полностью зеркальной

Резервная копия должна создаваться раз в день, в системном логе должна появляться запись об успешном или неуспешном выполнении операции

Резервная копия размещается локально, в директории /tmp/backup

На проверку направить файл crontab и скриншот с результатом работы утилиты.


### Решение 2  


Создание скрипта для резервного копирования

![Скрипт](/img/2.png) 


Добавление скрипта в крон, на ежденевный запуск в 3 ночи

![Крон](/img/2_1.png) 

Ручной запуск скрипта и проверка диркетории. 

![Проверка](/img/2_2.png) 



### Задание 3   


Настройте ограничение на используемую пропускную способность rsync до 1 Мбит/c

Проверьте настройку, синхронизируя большой файл между двумя серверами

На проверку направьте команду и результат ее выполнения в виде скриншота

### Решение 3 


rsync --bwlimit=125 -avz ./bigfile slava@192.168.0.119:/tmp


Создание большого файла  

![Файл](/img/3.png) 

Отправка его на другой сервер с лимитом скорости 
 
![Отправка](/img/3_1.png) 


### Задание 4*   


Напишите скрипт, который будет производить инкрементное резервное копирование домашней директории пользователя с помощью rsync на другой сервер  

Скрипт должен удалять старые резервные копии (сохранять только последние 5 штук)  

Напишите скрипт управления резервными копиями, в нем можно выбрать резервную копию и данные восстановятся к состоянию на момент создания данной резервной копии.  

На проверку направьте скрипт и скриншоты, демонстрирующие его работу в различных сценариях.  


### Решение 4  

Создаем скрипт для создания бекапов  

![Скрпит](/img/4.png) 

Создаем скрипт для восстановления бекапов  

![Скрипт](/img/4_1.png) 


Смотрим файлы в директории используемой для бекапа

![Файлы](/img/4_2.png) 

Запускаем бекап  

![Запуск](/img/4_3.png) 


Запускаем скрипт еще 10 раз и проверяем что на удаленном сервере остались лишь последнии 5 бекапов 

![Проверка](/img/4_4.png) 


Удаляем файлы в домашней директории перед восстановлением 

![Удаление](/img/4_5.png) 


Запускаем восстановление, выбираем бекап и проверяем что файлы восстановились 


![Восстановление](/img/4_6.png) 
